%nav{'aria-label': 'breadcrumb'}
  %ol.breadcrumb
    %li.breadcrumb-item
      %a{href: '/ics/sessions'} Sessions
    %li.breadcrumb-item.active Session ##{@session.id}

.row.mb-4
  .col-12
    .card
      .card-header.d-flex.justify-content-between.align-items-center
        %h5.mb-0
          %i.bi.bi-info-circle.me-2
          Session Details
        - if @session.reviewed?
          %span.badge.bg-success
            %i.bi.bi-check-circle.me-1
            Reviewed
        - else
          %span.badge.bg-warning.text-dark
            %i.bi.bi-clock.me-1
            Pending Review
      .card-body
        .row
          .col-md-6
            %p
              %strong Restaurant:
              = @session.potential_restaurant_name || 'Unknown'
            %p
              %strong Address:
              = @session.potential_address || 'Unknown'
          .col-md-6
            %p
              %strong Location:
              - if @session.lat && @session.lng
                = "#{@session.lat.round(6)}, #{@session.lng.round(6)}"
              - else
                Unknown
            %p
              %strong Created:
              = @session.created_at&.strftime('%Y-%m-%d %H:%M:%S')

%h5.mb-3
  %i.bi.bi-images.me-2
  Photos
.row.mb-4
  - @session.photo_urls_array.each_with_index do |url, index|
    .col-6.col-md-4.col-lg-3.mb-3
      .card
        %img.card-img-top{src: url, alt: "Menu photo #{index + 1}", style: 'height: 200px; object-fit: cover;'}
        .card-footer.text-center
          %small.text-muted Photo #{index + 1}

- unless @session.reviewed?
  .card.mb-4
    .card-header
      %h5.mb-0
        %i.bi.bi-shop.me-2
        Restaurant Actions
    .card-body
      .row.mb-4
        .col-md-6
          .card.h-100
            .card-body.text-center
              %h6.card-title
                %i.bi.bi-plus-circle.me-2
                Create New Restaurant
              %p.card-text.text-muted.small
                Create a new restaurant pre-filled with session data (name, address, location, menus)
              %form{action: "/ics/sessions/#{@session.id}/create_restaurant", method: 'post'}
                %button.btn.btn-primary{type: 'submit'}
                  %i.bi.bi-building-add.me-2
                  Create Restaurant from Session
        .col-md-6
          .card.h-100
            .card-body
              %h6.card-title
                %i.bi.bi-link-45deg.me-2
                Associate with Existing
              %form{action: "/ics/sessions/#{@session.id}/review", method: 'post'}
                .mb-2
                  %select.form-select.form-select-sm{name: 'restaurant_id', id: 'restaurant_id'}
                    %option{value: ''} -- Select restaurant --
                    - @restaurants.each do |r|
                      %option{value: r.id}= "#{r.name} - #{r.address}"
                %button.btn.btn-success.btn-sm{type: 'submit'}
                  %i.bi.bi-check-circle.me-2
                  Link & Mark Reviewed

      .text-center
        %form{action: "/ics/sessions/#{@session.id}/review", method: 'post'}
          %button.btn.btn-outline-secondary{type: 'submit'}
            %i.bi.bi-skip-forward.me-2
            Skip - Mark as Reviewed Without Restaurant
